var gulp  = require('gulp');
var shell = require('gulp-shell');
var ghPages = require('gulp-gh-pages');
// var path = require('path');
// var run = require('gulp-run');

//-----------------------IAAS--------------------------------------
gulp.task('iaas',shell.task(['./scripts/ssh']));

// gulp.task('iaas', function(){
//     return run(path.join(__dirname,'scripts','ssh')).exec();
// });
//---------------------------------------------------------------------------


//empujar a gh-pages el directorio book
// gulp.task('deploy-gh-pages', function() {
//       return gulp.src('./gh-pages/*')
//         .pipe(ghPages());
// });


//  "deploy-gitbook": "./scripts/losh deploy-gitbook",
gulp.task('deploy', deploygh);

gulp.task('empujar', //[build]
 shell.task(
    "git add ."+
    ";"+
    "git commit -am 'deploy to github'"+
    ";"+
    "git push origin master",//+
    //";"+
    //"git push heroku master",
    { verbose: true }
  )
);

var deploygh = function() {
  "use strict";
  let gh = require('gh-pages');

  //process.env.CMDDESC="Deploy GitBook on Github";

  let json = require('./package.json');
  let REPO = json.repository.url;
  console.log( "Repositorio:"+REPO);

  gh.publish('./gh-pages', { repo: REPO, logger: function(m) { console.error(m); } });
};


//creacion de pdf emobi y epub
gulp.task('crea-archivos',['pdf','mobi','epub']);

gulp.task('pdf',
  shell.task(
    "gitbook pdf ./txt",
    { verbose: true })
);

gulp.task('mobi',
  shell.task(
    "gitbook mobi",
    { verbose: true })
);

gulp.task('epub',
  shell.task(
    "gitbook epub",
    { verbose: true })
);

// npm install -g http-server
//  "generate-gitbook": "./scripts/generate-gitbook",
gulp.task('build', function() {
  return gulp.src(' ').pipe(shell(['./scripts/generate-gitbook']));
  //shell(['./scripts/generate-gitbook']);
});
